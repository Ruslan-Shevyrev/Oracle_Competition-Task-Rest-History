–ó–∞–¥–∞—á–∞
–ó–∞–¥–∞—á–∞ –±—ã–ª–∞ –¥–∞–Ω–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –≤ –æ–¥–Ω–æ–º –∏–∑ –±–∞–Ω–∫–æ–≤ –Ω–∞—à–µ–º—É –ø–æ–¥–ø–∏—Å—á–∏–∫—É.
–ü–æ—ç—Ç–æ–º—É –≤—Å–µ —Å—Ç–æ–Ω—ã –æ –Ω–µ—á–µ—Ç–∫–∏—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞—Ö –∑–∞–¥–∞—á–∏ –∏ —Ç.–ø. –Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ ‚Äú–°–ø–æ—Ä—Ç–ª–æ—Ç–æ‚Äù üòä

–ò–º–µ–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ rest_history.
:one: id_dog  - id –¥–æ–≥–æ–≤–æ—Ä–∞
:two: dt - –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–∞ 
:three: balance - –æ—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω—Ü–µ –¥–Ω—è dt (0 –∏–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π)

–£—Å–ª–æ–≤–∏—è:
:one: –Ω–∞ –∫–∞–∂–¥—É—é –¥–∞—Ç—É –º–∞–∫—Å–∏–º—É–º –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ –º–µ–Ω—è–ª—Å—è;
:two: –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ —Å –Ω–µ–Ω—É–ª–µ–≤—ã–º –æ—Å—Ç–∞—Ç–∫–æ–º.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å: 
:one: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–µ—Ä–∏–æ–¥—ã, –∫–æ–≥–¥–∞ –æ–Ω –∏–º–µ–ª –Ω–µ–Ω—É–ª–µ–≤–æ–π –æ—Å—Ç–∞—Ç–æ–∫;
:two: –ø–µ—Ä–∏–æ–¥ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∞—Ç–æ–π dt-1 —Å—Ç—Ä–æ–∫–∏ —Å –Ω—É–ª–µ–≤—ã–º –æ—Å—Ç–∞—Ç–∫–æ–º;
:three: e—Å–ª–∏ –Ω–µ–Ω—É–ª–µ–≤–æ–π –æ—Å—Ç–∞—Ç–æ–∫ –æ—Å—Ç–∞–µ—Ç—Å—è, —Ç–æ –ø–µ—Ä–∏–æ–¥ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∞—Ç–æ–π 31.12.2999.

–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
'''
with rest_history (id_dog, dt, balance) as (
select 111, to_date('10.07.2022', 'dd.mm.yyyy'), 10 from dual union all
select 111, to_date('15.08.2022', 'dd.mm.yyyy'), 0  from dual union all
select 111, to_date('20.09.2022', 'dd.mm.yyyy'), 15 from dual union all
select 111, to_date('15.07.2022', 'dd.mm.yyyy'), 25 from dual union all
select 111, to_date('15.07.2022', 'dd.mm.yyyy'), 35 from dual union all
select 222, to_date('15.07.2022', 'dd.mm.yyyy'), 5  from dual union all
select 222, to_date('15.08.2022', 'dd.mm.yyyy'), 7  from dual union all
select 222, to_date('15.09.2022', 'dd.mm.yyyy'), 0  from dual union all
select 222, to_date('03.03.2023', 'dd.mm.yyyy'), 33  from dual union all
select 222, to_date('04.04.2023', 'dd.mm.yyyy'), 44 from dual union all
select 222, to_date('10.05.2023', 'dd.mm.yyyy'), 0  from dual 
) select * from rest_history
'''

–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:
111 | 10.07.2022 | 14.08.2022
111 | 20.09.2022 | 31.12.2999
222 | 15.07.2022 | 14.09.2022
222 | 03.03.2023 | 09.05.2023